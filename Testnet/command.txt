╔════════════════════════════════════════════════════════════════════════════════╗
║                   POATC BLOCKCHAIN - SETUP & COMMANDS                          ║
║                     Private Network (NetworkID: 1337)                          ║
╚════════════════════════════════════════════════════════════════════════════════╝

📋 MỤC LỤC:
  1. Khởi tạo và chạy nodes
  2. Kiểm tra trạng thái
  3. Quản lý peers
  4. Gửi giao dịch
  5. Kiểm tra POATC features

════════════════════════════════════════════════════════════════════════════════

🔧 1. KHỞI TẠO VÀ CHẠY NODES

┌─────────────────────────────────────────────────────────────────────────────┐
│ CÁCH 1: Dùng Script Tự Động (Khuyến nghị)                                  │
└─────────────────────────────────────────────────────────────────────────────┘

  PowerShell:
  > cd C:\Users\User\Desktop\POAI_Trace-\testnet
  > .\restart_nodes.ps1

  Script này sẽ:
  ✓ Tự động stop các node cũ
  ✓ Khởi động Node1 và Node2 với cấu hình đúng
  ✓ Kiểm tra trạng thái nodes
  ✓ Hiển thị hướng dẫn


┌─────────────────────────────────────────────────────────────────────────────┐
│ CÁCH 2: Chạy Thủ Công (Chi tiết)                                           │
└─────────────────────────────────────────────────────────────────────────────┘

═══ NODE 1 ═══════════════════════════════════════════════════════════════════

  Khởi tạo (chỉ chạy 1 lần đầu):
  ─────────────────────────────────
  ../hdchain.exe init --datadir ./node1 ./poatc-genesis.json


  Chạy Node1:
  ─────────────────────────────────
../hdchain.exe --datadir ./node1 `
  --networkid 1337 `
  --port 30305 `
  --http `
  --http.addr "127.0.0.1" `
  --http.port 8545 `
  --http.api eth,net,web3,txpool,debug,personal,admin,clique,miner,poatc `
  --http.corsdomain "*" `
  --http.vhosts "*" `
  --ws `
  --ws.addr "127.0.0.1" `
  --ws.port 8546 `
  --ws.api eth,net,web3,txpool,debug,personal,admin,clique,miner,poatc `
  --ws.origins "*" `
  --allow-insecure-unlock `
  --syncmode full `
  --mine `
    --miner.etherbase "0x3003d6498603fAD5F232452B21c8B6EB798d20f1" `
    --unlock "0x3003d6498603fAD5F232452B21c8B6EB798d20f1" `
    --password ./password.txt `
    --nodiscover `
  --verbosity 3

  Thông tin:
  - RPC Port: 8545
  - WS Port: 8546
  - P2P Port: 30305
  - Miner: 0x3003d6498603fAD5F232452B21c8B6EB798d20f1


═══ NODE 2 ═══════════════════════════════════════════════════════════════════

  Khởi tạo (chỉ chạy 1 lần đầu):
  ─────────────────────────────────
  ../hdchain.exe init --datadir ./node2 ./poatc-genesis.json


  Chạy Node2:
  ─────────────────────────────────
../hdchain.exe --datadir ./node2 `
  --networkid 1337 `
  --port 30306 `
    --http `
    --http.addr "127.0.0.1" `
    --http.port 8549 `
  --http.api eth,net,web3,txpool,debug,personal,admin,clique,miner,poatc `
  --http.corsdomain "*" `
  --http.vhosts "*" `
    --ws `
    --ws.addr "127.0.0.1" `
    --ws.port 8550 `
  --ws.api eth,net,web3,txpool,debug,personal,admin,clique,miner,poatc `
  --ws.origins "*" `
    --ipcpath \\\\.\\pipe\\geth-node2.ipc `
  --authrpc.addr "127.0.0.1" `
  --authrpc.port 8552 `
  --allow-insecure-unlock `
  --syncmode full `
  --mine `
    --miner.etherbase 0xE22bb120826219E8ec00d3af3d16EFE7cADe7B08 `
    --unlock 0xE22bb120826219E8ec00d3af3d16EFE7cADe7B08 `
    --password ./password.txt `
    --nodiscover `
    --bootnodes enode://93c6772703fa32c1f91a8f10bbf92b7877c4ecfea478afddcf90574bbbb878d7bf4e3ba10c20fb9eb57adc0545e378f45781643fcd20f635fb4bbd5860b502b6@127.0.0.1:30305 `
  --verbosity 3

  Thông tin:
  - RPC Port: 8549
  - WS Port: 8550
  - P2P Port: 30306
  - Miner: 0xE22bb120826219E8ec00d3af3d16EFE7cADe7B08


⚠️  LƯU Ý QUAN TRỌNG:
  • Dùng --nodiscover để KHÔNG kết nối ra mạng Ethereum mainnet
  • Bootnode dùng 127.0.0.1 (localhost) → Không bị ảnh hưởng khi đổi WiFi
  • Cả 2 nodes phải dùng cùng genesis file: poatc-genesis.json


════════════════════════════════════════════════════════════════════════════════

📊 2. KIỂM TRA TRẠNG THÁI NODES

┌─────────────────────────────────────────────────────────────────────────────┐
│ Kiểm tra Node đang chạy                                                     │
└─────────────────────────────────────────────────────────────────────────────┘

  netstat -ano | findstr "8545 8549 30305 30306"


┌─────────────────────────────────────────────────────────────────────────────┐
│ Kiểm tra Block Number                                                       │
└─────────────────────────────────────────────────────────────────────────────┘

  Node1:
  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' -ContentType 'application/json').Content

  Node2:
  (Invoke-WebRequest -Uri http://127.0.0.1:8549 -Method POST -Body '{"jsonrpc":"2.0","method":"eth_blockNumber","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Kiểm tra Số lượng Peers                                                     │
└─────────────────────────────────────────────────────────────────────────────┘

  Node1:
  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"net_peerCount","params":[],"id":1}' -ContentType 'application/json').Content

  Node2:
  (Invoke-WebRequest -Uri http://127.0.0.1:8549 -Method POST -Body '{"jsonrpc":"2.0","method":"net_peerCount","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Kiểm tra Mining Status                                                      │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"eth_mining","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Kiểm tra Clique Signers                                                     │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"clique_getSigners","params":[],"id":1}' -ContentType 'application/json').Content


════════════════════════════════════════════════════════════════════════════════

🔗 3. QUẢN LÝ PEERS

┌─────────────────────────────────────────────────────────────────────────────┐
│ Xem chi tiết Peers                                                          │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"admin_peers","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Lấy Enode URL của Node                                                      │
└─────────────────────────────────────────────────────────────────────────────┘

  Node1:
  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"admin_nodeInfo","params":[],"id":1}' -ContentType 'application/json').Content | ConvertFrom-Json | Select-Object -ExpandProperty result | Select-Object -ExpandProperty enode

  Node2:
  (Invoke-WebRequest -Uri http://127.0.0.1:8549 -Method POST -Body '{"jsonrpc":"2.0","method":"admin_nodeInfo","params":[],"id":1}' -ContentType 'application/json').Content | ConvertFrom-Json | Select-Object -ExpandProperty result | Select-Object -ExpandProperty enode


┌─────────────────────────────────────────────────────────────────────────────┐
│ Kết nối Peers Thủ công (Nếu cần)                                            │
└─────────────────────────────────────────────────────────────────────────────┘

  Thêm Node2 vào Node1:
  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"admin_addPeer","params":["enode://b219e13e3f40ba1788f4cc67f64b24e3c6d4c0ec44bcb09041614a1eabe541f0546a13c5db47fe56b3fd9463b5c7c906d674d4aa2f61daf544187618fed1a510@127.0.0.1:30306"],"id":1}' -ContentType 'application/json').Content

  Thêm Node1 vào Node2:
  (Invoke-WebRequest -Uri http://127.0.0.1:8549 -Method POST -Body '{"jsonrpc":"2.0","method":"admin_addPeer","params":["enode://93c6772703fa32c1f91a8f10bbf92b7877c4ecfea478afddcf90574bbbb878d7bf4e3ba10c20fb9eb57adc0545e378f45781643fcd20f635fb4bbd5860b502b6@127.0.0.1:30305"],"id":1}' -ContentType 'application/json').Content


════════════════════════════════════════════════════════════════════════════════

💸 4. GỬI GIAO DỊCH

┌─────────────────────────────────────────────────────────────────────────────┐
│ Kiểm tra Balance                                                            │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"eth_getBalance","params":["0x3003d6498603fAD5F232452B21c8B6EB798d20f1","latest"],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Gửi Giao dịch (Node1 → Node2)                                               │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"eth_sendTransaction","params":[{"from":"0x3003d6498603fAD5F232452B21c8B6EB798d20f1","to":"0xE22bb120826219E8ec00d3af3d16EFE7cADe7B08","value":"0x16345785D8A0000","gas":"0x5208"}],"id":1}' -ContentType 'application/json').Content

  Giá trị: 0x16345785D8A0000 = 0.1 ETH


┌─────────────────────────────────────────────────────────────────────────────┐
│ Xem Transaction Receipt                                                     │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"eth_getTransactionReceipt","params":["0xYOUR_TX_HASH_HERE"],"id":1}' -ContentType 'application/json').Content


════════════════════════════════════════════════════════════════════════════════

🛡️ 5. KIỂM TRA POATC FEATURES

┌─────────────────────────────────────────────────────────────────────────────┐
│ Anomaly Detection Stats                                                     │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getAnomalyStats","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Reputation System                                                           │
└─────────────────────────────────────────────────────────────────────────────┘

  Kiểm tra Reputation của Node1:
  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getReputation","params":["0x3003d6498603fAD5F232452B21c8B6EB798d20f1"],"id":1}' -ContentType 'application/json').Content

  Kiểm tra Reputation Stats:
  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getReputationStats","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Validator Selection Stats                                                   │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getValidatorSelectionStats","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Tracing System Stats                                                        │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getTracingStats","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Time Dynamic Stats                                                          │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getTimeDynamicStats","params":[],"id":1}' -ContentType 'application/json').Content


┌─────────────────────────────────────────────────────────────────────────────┐
│ Whitelist/Blacklist Stats                                                   │
└─────────────────────────────────────────────────────────────────────────────┘

  (Invoke-WebRequest -Uri http://127.0.0.1:8545 -Method POST -Body '{"jsonrpc":"2.0","method":"poatc_getWhitelistBlacklistStats","params":[],"id":1}' -ContentType 'application/json').Content


════════════════════════════════════════════════════════════════════════════════

🌐 6. WEB DASHBOARD

┌─────────────────────────────────────────────────────────────────────────────┐
│ Khởi động Dashboard                                                         │
└─────────────────────────────────────────────────────────────────────────────┘

  cd explorer
  .\start_dashboard.bat

  Hoặc:
  python -m http.server 8080

  Truy cập: http://localhost:8080


════════════════════════════════════════════════════════════════════════════════

📝 THÔNG TIN ACCOUNTS

  Node1 (Validator):
  ├─ Address: 0x3003d6498603fAD5F232452B21c8B6EB798d20f1
  ├─ Balance: 1,000,000 ETH (genesis allocation)
  └─ Role: Validator & Miner

  Node2 (Validator):
  ├─ Address: 0xE22bb120826219E8ec00d3af3d16EFE7cADe7B08
  ├─ Balance: 1,000,000 ETH (genesis allocation)
  └─ Role: Validator & Miner

  Password (cả 2 accounts): 2004


════════════════════════════════════════════════════════════════════════════════

🔧 TROUBLESHOOTING

  ❌ Nodes không peer với nhau:
     → Chạy lệnh add peer thủ công (Mục 3)
     → Kiểm tra firewall có block port 30305, 30306 không

  ❌ RPC không hoạt động:
     → Kiểm tra node có đang chạy: netstat -ano | findstr "8545"
     → Restart node bằng script restart_nodes.ps1

  ❌ Transaction failed:
     → Kiểm tra account có unlock không
     → Kiểm tra balance đủ không
     → Đảm bảo gửi từ node có key (Node1 hoặc Node2)

  ❌ Dashboard không kết nối:
     → Kiểm tra CORS: --http.corsdomain "*" đã được thêm
     → Restart nodes với config mới


════════════════════════════════════════════════════════════════════════════════

📚 LINKS QUAN TRỌNG

  • Genesis File: testnet/poatc-genesis.json
  • Whitelist/Blacklist Config: testnet/whitelist_blacklist.json
  • Restart Script: testnet/restart_nodes.ps1
  • Dashboard: testnet/explorer/
  • Technical Docs: TECHNICAL_DOCUMENTATION.md


════════════════════════════════════════════════════════════════════════════════
                           ✨ POATC Blockchain v1.0 ✨
════════════════════════════════════════════════════════════════════════════════
